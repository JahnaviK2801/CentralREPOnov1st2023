This is logic B related code

Completed logic B related code

This is logic A related code

Completed logic A related code
